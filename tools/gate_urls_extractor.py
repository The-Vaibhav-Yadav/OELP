#!/usr/bin/env python3
"""
GATE PDF URLs Extractor

This module contains the exact URLs for GATE PDFs as extracted from the website.
Useful for understanding URL patterns and for debugging download issues.

Based on the HTML content from usemynotes.com
"""

# Based on the website content, here are the actual URL patterns for each year:

GATE_PDF_URLS = {
    2025: {
        "AE": "https://gate2026.iitg.ac.in/doc/download/2025/AE2025.pdf",
        "AG": "https://gate2026.iitg.ac.in/doc/download/2025/AG2025.pdf", 
        "AR": "https://gate2026.iitg.ac.in/doc/download/2025/AR2025.pdf",
        "BM": "https://gate2026.iitg.ac.in/doc/download/2025/BM2025.pdf",
        "BT": "https://gate2026.iitg.ac.in/doc/download/2025/BT2025.pdf",
        "CE": "https://gate2026.iitg.ac.in/doc/download/2025/CE2025.pdf",
        "CH": "https://gate2026.iitg.ac.in/doc/download/2025/CH2025.pdf",
        "CS": "https://gate2026.iitg.ac.in/doc/download/2025/CS2025.pdf",
        "CY": "https://gate2026.iitg.ac.in/doc/download/2025/CY2025.pdf",
        "DA": "https://gate2026.iitg.ac.in/doc/download/2025/DA2025.pdf",
        "EC": "https://gate2026.iitg.ac.in/doc/download/2025/EC2025.pdf",
        "EE": "https://gate2026.iitg.ac.in/doc/download/2025/EE2025.pdf",
        "EN": "https://gate2026.iitg.ac.in/doc/download/2025/EN2025.pdf",
        "ES": "https://gate2026.iitg.ac.in/doc/download/2025/ES2025.pdf",
        "EY": "https://gate2026.iitg.ac.in/doc/download/2025/EY2025.pdf",
        "GE": "https://gate2026.iitg.ac.in/doc/download/2025/GE2025.pdf",
        "GG": "https://gate2026.iitg.ac.in/doc/download/2025/GG2025.pdf",
        "IN": "https://gate2026.iitg.ac.in/doc/download/2025/IN2025.pdf",
        "MA": "https://gate2026.iitg.ac.in/doc/download/2025/MA2025.pdf",
        "ME": "https://gate2026.iitg.ac.in/doc/download/2025/ME2025.pdf",
        "MN": "https://gate2026.iitg.ac.in/doc/download/2025/MN2025.pdf",
        "MT": "https://gate2026.iitg.ac.in/doc/download/2025/MT2025.pdf",
        "NM": "https://gate2026.iitg.ac.in/doc/download/2025/NM2025.pdf",
        "PE": "https://gate2026.iitg.ac.in/doc/download/2025/PE2025.pdf",
        "PH": "https://gate2026.iitg.ac.in/doc/download/2025/PH2025.pdf",
        "PI": "https://gate2026.iitg.ac.in/doc/download/2025/PI2025.pdf",
        "ST": "https://gate2026.iitg.ac.in/doc/download/2025/ST2025.pdf",
        "TF": "https://gate2026.iitg.ac.in/doc/download/2025/TF2025.pdf",
        "XE": "https://gate2026.iitg.ac.in/doc/download/2025/XE2025.pdf",
        "XL": "https://gate2026.iitg.ac.in/doc/download/2025/XL2025.pdf"
    },
    2024: {
        "AE": "https://gate2026.iitg.ac.in/doc/download/2024/AE2024.pdf",
        "AG": "https://gate2026.iitg.ac.in/doc/download/2024/AG2024.pdf",
        "AR": "https://gate2026.iitg.ac.in/doc/download/2024/AR2024.pdf",
        "BM": "https://gate2026.iitg.ac.in/doc/download/2024/BM2024.pdf",
        "BT": "https://gate2026.iitg.ac.in/doc/download/2024/BT2024.pdf",
        "CE": "https://gate2026.iitg.ac.in/doc/download/2024/CE2024.pdf",
        "CH": "https://gate2026.iitg.ac.in/doc/download/2024/CH2024.pdf",
        "CS": "https://gate2026.iitg.ac.in/doc/download/2024/CS2024.pdf",
        "CY": "https://gate2026.iitg.ac.in/doc/download/2024/CY2024.pdf",
        "DA": "https://gate2026.iitg.ac.in/doc/download/2024/DA2024.pdf",
        "EC": "https://gate2026.iitg.ac.in/doc/download/2024/EC2024.pdf",
        "EE": "https://gate2026.iitg.ac.in/doc/download/2024/EE2024.pdf",
        "EN": "https://gate2026.iitg.ac.in/doc/download/2024/EN2024.pdf",
        "ES": "https://gate2026.iitg.ac.in/doc/download/2024/ES2024.pdf",
        "EY": "https://gate2026.iitg.ac.in/doc/download/2024/EY2024.pdf",
        "GE": "https://gate2026.iitg.ac.in/doc/download/2024/GE2024.pdf",
        "GG": "https://gate2026.iitg.ac.in/doc/download/2024/GG2024.pdf",
        "IN": "https://gate2026.iitg.ac.in/doc/download/2024/IN2024.pdf",
        "MA": "https://gate2026.iitg.ac.in/doc/download/2024/MA2024.pdf",
        "ME": "https://gate2026.iitg.ac.in/doc/download/2024/ME2024.pdf",
        "MN": "https://gate2026.iitg.ac.in/doc/download/2024/MN2024.pdf",
        "MT": "https://gate2026.iitg.ac.in/doc/download/2024/MT2024.pdf",
        "NM": "https://gate2026.iitg.ac.in/doc/download/2024/NM2024.pdf",
        "PE": "https://gate2026.iitg.ac.in/doc/download/2024/PE2024.pdf",
        "PH": "https://gate2026.iitg.ac.in/doc/download/2024/PH2024.pdf",
        "PI": "https://gate2026.iitg.ac.in/doc/download/2024/PI2024.pdf",
        "ST": "https://gate2026.iitg.ac.in/doc/download/2024/ST2024.pdf",
        "TF": "https://gate2026.iitg.ac.in/doc/download/2024/TF2024.pdf",
        "XE": "https://gate2026.iitg.ac.in/doc/download/2024/XE2024.pdf",
        "XL": "https://gate2026.iitg.ac.in/doc/download/2024/XL2024.pdf"
    },
    2023: {
        "AE": "https://gate2026.iitg.ac.in/doc/download/2023/ae_2023.pdf",
        "AG": "https://gate2026.iitg.ac.in/doc/download/2023/ag_2023.pdf",
        "AR": "https://gate2026.iitg.ac.in/doc/download/2023/ar_2023.pdf",
        "BM": "https://gate2026.iitg.ac.in/doc/download/2023/bm_2023.pdf",
        "BT": "https://gate2026.iitg.ac.in/doc/download/2023/bt_2023.pdf",
        "CE": "https://gate2026.iitg.ac.in/doc/download/2023/ce_2023.pdf",
        "CH": "https://gate2026.iitg.ac.in/doc/download/2023/ch_2023.pdf",
        "CS": "https://gate2026.iitg.ac.in/doc/download/2023/cs_2023.pdf",
        "CY": "https://gate2026.iitg.ac.in/doc/download/2023/cy_2023.pdf",
        "DA": "https://gate2026.iitg.ac.in/doc/download/2023/da_2023.pdf",
        "EC": "https://gate2026.iitg.ac.in/doc/download/2023/ec_2023.pdf",
        "EE": "https://gate2026.iitg.ac.in/doc/download/2023/ee_2023.pdf",
        "EN": "https://gate2026.iitg.ac.in/doc/download/2023/en_2023.pdf",
        "ES": "https://gate2026.iitg.ac.in/doc/download/2023/es_2023.pdf",
        "EY": "https://gate2026.iitg.ac.in/doc/download/2023/ey_2023.pdf",
        "GE": "https://gate2026.iitg.ac.in/doc/download/2023/ge_2023.pdf",
        "GG": "https://gate2026.iitg.ac.in/doc/download/2023/gg_2023.pdf",
        "IN": "https://gate2026.iitg.ac.in/doc/download/2023/in_2023.pdf",
        "MA": "https://gate2026.iitg.ac.in/doc/download/2023/ma_2023.pdf",
        "ME": "https://gate2026.iitg.ac.in/doc/download/2023/me_2023.pdf",
        "MN": "https://gate2026.iitg.ac.in/doc/download/2023/mn_2023.pdf",
        "MT": "https://gate2026.iitg.ac.in/doc/download/2023/mt_2023.pdf",
        "NM": "https://gate2026.iitg.ac.in/doc/download/2023/nm_2023.pdf",
        "PE": "https://gate2026.iitg.ac.in/doc/download/2023/pe_2023.pdf",
        "PH": "https://gate2026.iitg.ac.in/doc/download/2023/ph_2023.pdf",
        "PI": "https://gate2026.iitg.ac.in/doc/download/2023/pi_2023.pdf",
        "ST": "https://gate2026.iitg.ac.in/doc/download/2023/st_2023.pdf",
        "TF": "https://gate2026.iitg.ac.in/doc/download/2023/tf_2023.pdf",
        "XE": "https://gate2026.iitg.ac.in/doc/download/2023/xe_2023.pdf",
        "XL": "https://gate2026.iitg.ac.in/doc/download/2023/xl_2023.pdf"
    },
    2022: {
        "AE": "https://gate2026.iitg.ac.in/doc/download/2022/ae_2022.pdf",
        "AG": "https://gate2026.iitg.ac.in/doc/download/2022/ag_2022.pdf",
        "AR": "https://gate2026.iitg.ac.in/doc/download/2022/ar_2022.pdf",
        "BM": "https://gate2026.iitg.ac.in/doc/download/2022/bm_2022.pdf",
        "BT": "https://gate2026.iitg.ac.in/doc/download/2022/bt_2022.pdf",
        "CE": "https://gate2026.iitg.ac.in/doc/download/2022/ce_2022.pdf",
        "CH": "https://gate2026.iitg.ac.in/doc/download/2022/ch_2022.pdf",
        "CS": "https://gate2026.iitg.ac.in/doc/download/2022/cs_2022.pdf",
        "CY": "https://gate2026.iitg.ac.in/doc/download/2022/cy_2022.pdf",
        "DA": "https://gate2026.iitg.ac.in/doc/download/2022/da_2022.pdf",
        "EC": "https://gate2026.iitg.ac.in/doc/download/2022/ec_2022.pdf",
        "EE": "https://gate2026.iitg.ac.in/doc/download/2022/ee_2022.pdf",
        "EN": "https://gate2026.iitg.ac.in/doc/download/2022/en_2022.pdf",
        "ES": "https://gate2026.iitg.ac.in/doc/download/2022/es_2022.pdf",
        "EY": "https://gate2026.iitg.ac.in/doc/download/2022/ey_2022.pdf",
        "GE": "https://gate2026.iitg.ac.in/doc/download/2022/ge_2022.pdf",
        "GG": "https://gate2026.iitg.ac.in/doc/download/2022/gg_2022.pdf",
        "IN": "https://gate2026.iitg.ac.in/doc/download/2022/in_2022.pdf",
        "MA": "https://gate2026.iitg.ac.in/doc/download/2022/ma_2022.pdf",
        "ME": "https://gate2026.iitg.ac.in/doc/download/2022/me_2022.pdf",
        "MN": "https://gate2026.iitg.ac.in/doc/download/2022/mn_2022.pdf",
        "MT": "https://gate2026.iitg.ac.in/doc/download/2022/mt_2022.pdf",
        "NM": "https://gate2026.iitg.ac.in/doc/download/2022/nm_2022.pdf",
        "PE": "https://gate2026.iitg.ac.in/doc/download/2022/pe_2022.pdf",
        "PH": "https://gate2026.iitg.ac.in/doc/download/2022/ph_2022.pdf",
        "PI": "https://gate2026.iitg.ac.in/doc/download/2022/pi_2022.pdf",
        "ST": "https://gate2026.iitg.ac.in/doc/download/2022/st_2022.pdf",
        "TF": "https://gate2026.iitg.ac.in/doc/download/2022/tf_2022.pdf",
        "XE": "https://gate2026.iitg.ac.in/doc/download/2022/xe_2022.pdf",
        "XL": "https://gate2026.iitg.ac.in/doc/download/2022/xl_2022.pdf"
    },
    2021: {
        "AE": "https://gate2026.iitg.ac.in/doc/download/2021/ae_2021.pdf",
        "AG": "https://gate2026.iitg.ac.in/doc/download/2021/ag_2021.pdf",
        "AR": "https://gate2026.iitg.ac.in/doc/download/2021/ar_2021.pdf",
        "BM": "https://gate2026.iitg.ac.in/doc/download/2021/bm_2021.pdf",
        "BT": "https://gate2026.iitg.ac.in/doc/download/2021/bt_2021.pdf",
        "CE": "https://gate2026.iitg.ac.in/doc/download/2021/ce_2021.pdf",
        "CH": "https://gate2026.iitg.ac.in/doc/download/2021/ch_2021.pdf",
        "CS": "https://gate2026.iitg.ac.in/doc/download/2021/cs_2021.pdf",
        "CY": "https://gate2026.iitg.ac.in/doc/download/2021/cy_2021.pdf",
        "EC": "https://gate2026.iitg.ac.in/doc/download/2021/ec_2021.pdf",
        "EE": "https://gate2026.iitg.ac.in/doc/download/2021/ee_2021.pdf",
        "EN": "https://gate2026.iitg.ac.in/doc/download/2021/es_2021.pdf",  # Note: website shows es_2021.pdf for EN
        "ES": "https://gate2026.iitg.ac.in/doc/download/2021/es_2021.pdf",
        "EY": "https://gate2026.iitg.ac.in/doc/download/2021/ey_2021.pdf",
        "GG": "https://gate2026.iitg.ac.in/doc/download/2021/gg_2021.pdf",
        "IN": "https://gate2026.iitg.ac.in/doc/download/2021/in_2021.pdf",
        "MA": "https://gate2026.iitg.ac.in/doc/download/2021/ma_2021.pdf",
        "ME": "https://gate2026.iitg.ac.in/doc/download/2021/me_2021.pdf",
        "MN": "https://gate2026.iitg.ac.in/doc/download/2021/mn_2021.pdf",
        "MT": "https://gate2026.iitg.ac.in/doc/download/2021/mt_2021.pdf",
        "PE": "https://gate2026.iitg.ac.in/doc/download/2021/pe_2021.pdf",
        "PH": "https://gate2026.iitg.ac.in/doc/download/2021/ph_2021.pdf",
        "PI": "https://gate2026.iitg.ac.in/doc/download/2021/pi_2021.pdf",
        "ST": "https://gate2026.iitg.ac.in/doc/download/2021/st_2021.pdf",
        "TF": "https://gate2026.iitg.ac.in/doc/download/2021/tf_2021.pdf",
        "XE": "https://gate2026.iitg.ac.in/doc/download/2021/xe_2021.pdf",
        "XL": "https://gate2026.iitg.ac.in/doc/download/2021/xl_2021.pdf"
        # Note: Some streams like DA, GE, NM may not be available for 2021
    }
}

def get_exact_url(year, stream):
    """Get the exact URL for a specific year and stream."""
    return GATE_PDF_URLS.get(year, {}).get(stream)

def get_all_urls_for_year(year):
    """Get all URLs for a specific year."""
    return GATE_PDF_URLS.get(year, {})

def get_all_urls_for_stream(stream):
    """Get all URLs for a specific stream across all years."""
    urls = {}
    for year, streams in GATE_PDF_URLS.items():
        if stream in streams:
            urls[year] = streams[stream]
    return urls

def print_url_summary():
    """Print summary of available URLs."""
    print("GATE PDF URLs Summary")
    print("=" * 50)
    
    for year in sorted(GATE_PDF_URLS.keys(), reverse=True):
        streams = GATE_PDF_URLS[year]
        print(f"Year {year}: {len(streams)} streams available")
        
        all_streams = set(["AE", "AG", "AR", "BM", "BT", "CE", "CH", "CS", "CY", "DA",
                          "EC", "EE", "EN", "ES", "EY", "GE", "GG", "IN", "MA", "ME",
                          "MN", "MT", "NM", "PE", "PH", "PI", "ST", "TF", "XE", "XL"])
        available_streams = set(streams.keys())
        missing_streams = all_streams - available_streams
        
        if missing_streams:
            print(f"  Missing: {', '.join(sorted(missing_streams))}")
        else:
            print(f"  ✅ All 30 streams available")
        print()

def check_url_accessibility():
    """Check which URLs are accessible (returns 200 status code)."""
    import requests
    
    print("Checking URL accessibility...")
    print("=" * 50)
    
    accessible = {}
    inaccessible = {}
    
    for year in sorted(GATE_PDF_URLS.keys(), reverse=True):
        print(f"\nChecking {year}...")
        accessible[year] = []
        inaccessible[year] = []
        
        for stream, url in GATE_PDF_URLS[year].items():
            try:
                response = requests.head(url, timeout=10)
                if response.status_code == 200:
                    accessible[year].append(stream)
                    print(f"  ✅ {stream}")
                else:
                    inaccessible[year].append(stream)
                    print(f"  ❌ {stream} (Status: {response.status_code})")
            except Exception as e:
                inaccessible[year].append(stream)
                print(f"  ❌ {stream} (Error: {str(e)[:50]}...)")
    
    # Summary
    print("\n" + "=" * 50)
    print("ACCESSIBILITY SUMMARY")
    print("=" * 50)
    
    for year in sorted(accessible.keys(), reverse=True):
        total = len(accessible[year]) + len(inaccessible[year])
        print(f"{year}: {len(accessible[year])}/{total} accessible")
        if inaccessible[year]:
            print(f"  Inaccessible: {', '.join(inaccessible[year])}")

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) > 1:
        if sys.argv[1] == "--check":
            check_url_accessibility()
        elif sys.argv[1] == "--stream" and len(sys.argv) > 2:
            stream = sys.argv[2].upper()
            urls = get_all_urls_for_stream(stream)
            print(f"URLs for {stream}:")
            for year, url in sorted(urls.items(), reverse=True):
                print(f"  {year}: {url}")
        elif sys.argv[1] == "--year" and len(sys.argv) > 2:
            year = int(sys.argv[2])
            urls = get_all_urls_for_year(year)
            print(f"URLs for {year}:")
            for stream, url in sorted(urls.items()):
                print(f"  {stream}: {url}")
        else:
            print("Usage:")
            print("  python tools/gate_urls_extractor.py                # Show summary")
            print("  python tools/gate_urls_extractor.py --check        # Check accessibility")
            print("  python tools/gate_urls_extractor.py --stream CS    # URLs for specific stream")
            print("  python tools/gate_urls_extractor.py --year 2025    # URLs for specific year")
    else:
        print_url_summary()
